<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ch√∫c M·ª´ng NƒÉm M·ªõi 2026 - An Khang Th·ªãnh V∆∞·ª£ng</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }

        body {
            overflow: hidden;
            background: linear-gradient(135deg, #8b0000 0%, #bc002d 100%);
            color: white;
            position: relative;
            min-height: 100vh;
        }

        /* H√¨nh n·ªÅn v·ªõi hi·ªáu ·ª©ng ph√°o hoa */
        .tet-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 30%, rgba(255, 215, 0, 0.3) 0%, transparent 25%),
                radial-gradient(circle at 80% 70%, rgba(255, 0, 0, 0.3) 0%, transparent 25%),
                radial-gradient(circle at 40% 80%, rgba(255, 105, 180, 0.3) 0%, transparent 25%),
                linear-gradient(135deg, #8b0000 0%, #bc002d 100%);
            z-index: 1;
        }

        /* Canvas ph√°o hoa n·ªÅn */
        #backgroundFireworks {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 2;
        }

        /* Container ch√≠nh */
        .container {
            position: relative;
            z-index: 10;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            padding: 20px;
        }

        /* Header */
        .header {
            text-align: center;
            padding: 20px 0 40px 0;
        }

        .title {
            background: linear-gradient(to right, #ffd700, #ff9500, #ffd700);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 40px rgba(255, 215, 0, 0.7);
            animation: glow 2s infinite alternate;
        }

        .title h1 {
            font-size: 4rem;
            margin-bottom: 15px;
            letter-spacing: 2px;
        }

        .title p {
            font-size: 2.5rem;
            font-weight: bold;
            letter-spacing: 1px;
        }

        @keyframes glow {
            0% { text-shadow: 0 0 20px rgba(255, 215, 0, 0.7); }
            100% { text-shadow: 0 0 40px rgba(255, 215, 0, 1), 0 0 60px rgba(255, 215, 0, 0.7); }
        }

        /* N·ªôi dung ch√≠nh - b·ªë c·ª•c 3 c·ªôt */
        .main-content {
            display: flex;
            flex: 1;
            gap: 30px;
            height: 70vh;
        }

        /* C·ªôt b√™n tr√°i - C√¢y ƒë√†o ƒë·∫πp */
        .left-column {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-end;
            position: relative;
        }

        /* C·ªôt b√™n ph·∫£i - C√¢y mai ƒë·∫πp */
        .right-column {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-end;
            position: relative;
        }

        /* C·ªôt gi·ªØa - 54 th·∫ª b√†i */
        .center-column {
            flex: 2;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
        }

        .cards-container {
            display: grid;
            grid-template-columns: repeat(9, 1fr);
            grid-template-rows: repeat(6, 1fr);
            gap: 12px;
            width: 100%;
            height: 100%;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 25px;
            backdrop-filter: blur(15px);
            border: 3px solid rgba(255, 215, 0, 0.4);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        /* Th·∫ª b√†i - ƒê√É S·ª¨A: K√≠ch th∆∞·ªõc s·ªë ti·ªÅn ph√π h·ª£p */
        .card {
            width: 100%;
            height: 100%;
            perspective: 1000px;
            cursor: pointer;
        }

        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            transform-style: preserve-3d;
            border-radius: 12px;
        }

        .card.flipped .card-inner {
            transform: rotateY(180deg);
        }

        .card-front, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 8px;
            overflow: hidden;
            box-sizing: border-box;
        }

        .card-front {
            background: linear-gradient(135deg, #bc002d, #8b0000);
            border: 3px solid #ffd700;
            box-shadow: 
                inset 0 0 20px rgba(0, 0, 0, 0.2),
                0 8px 20px rgba(0, 0, 0, 0.4);
        }

        .card-back {
            background: linear-gradient(135deg, #ffd700, #ff9500);
            transform: rotateY(180deg);
            color: #bc002d;
            font-weight: 900;
            box-shadow: inset 0 0 30px rgba(255, 255, 255, 0.3);
        }

        .horse-icon {
            font-size: 2rem;
            margin-bottom: 5px;
            filter: drop-shadow(2px 2px 4px rgba(0, 0, 0, 0.3));
        }

        .card-text {
            font-size: 0.8rem;
            font-weight: bold;
            color: #ffd700;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
        }

        /* S·ª¨A QUAN TR·ªåNG: S·ªë ti·ªÅn v·ª´a v·ªõi bao l√¨ x√¨ */
        .money-amount {
            font-size: 1.6rem;
            font-weight: 900;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            padding: 6px 8px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            border: 2px solid #bc002d;
            line-height: 1.1;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            text-align: center;
            box-sizing: border-box;
            max-height: 90%;
            word-break: break-word;
        }

        /* Container c√¢y - ƒê√É S·ª¨A: K√≠ch th∆∞·ªõc l·ªõn h∆°n */
        .tree-container {
            width: 100%;
            height: 120%; /* TƒÉng chi·ªÅu cao */
            position: relative;
            display: flex;
            justify-content: center;
            align-items: flex-end;
            margin-bottom: -20%; /* ƒê·ªÉ c√¢y kh√¥ng b·ªã c·∫Øt */
            transform: scale(1.2); /* Ph√≥ng to to√†n b·ªô c√¢y */
            transform-origin: bottom center;
        }

        /* SVG Tree Styling - ƒê√É S·ª¨A: K√≠ch th∆∞·ªõc l·ªõn h∆°n */
        .tree-svg {
            width: 120%;
            height: 120%;
            filter: drop-shadow(0 15px 25px rgba(0, 0, 0, 0.4));
            animation: swayTree 8s ease-in-out infinite;
            transform-origin: bottom center;
        }

        @keyframes swayTree {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(1deg); }
            75% { transform: rotate(-1deg); }
        }

        /* L√¨ x√¨ treo tr√™n c√¢y - ƒê√É S·ª¨A: To h∆°n theo t·ª∑ l·ªá */
        .tree-envelope {
            position: absolute;
            width: 60px; /* TƒÉng t·ª´ 50px */
            height: 85px; /* TƒÉng t·ª´ 70px */
            background: linear-gradient(135deg, #bc002d, #8b0000);
            border: 3px solid #ffd700;
            border-radius: 8px;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #ffd700;
            font-weight: bold;
            font-size: 1.8rem; /* TƒÉng t·ª´ 1.5rem */
            z-index: 100;
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3);
            animation: swingEnvelope 4s ease-in-out infinite;
            cursor: pointer;
        }

        @keyframes swingEnvelope {
            0%, 100% { transform: rotate(-8deg); }
            50% { transform: rotate(8deg); }
        }

        /* V·∫≠t ph·∫©m r∆°i d√†y ƒë·∫∑c */
        .falling-item {
            position: absolute;
            z-index: 5;
            animation: fallItem linear infinite;
            pointer-events: none;
        }

        @keyframes fallItem {
            0% {
                transform: translateY(-100px) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(600px) rotate(360deg);
                opacity: 0;
            }
        }

        /* Th√¥ng tin ·ªü d∆∞·ªõi */
        .info {
            text-align: center;
            padding: 25px;
            margin-top: 30px;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 20px;
            backdrop-filter: blur(20px);
            border: 3px solid rgba(255, 215, 0, 0.5);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }

        .stats {
            display: flex;
            justify-content: center;
            gap: 60px;
            margin-top: 15px;
        }

        .stat-item {
            font-size: 1.5rem;
            color: #ffd700;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .stat-item i {
            font-size: 2rem;
        }

        /* N√∫t √¢m nh·∫°c nh·ªè */
        .music-control {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 100;
        }

        .music-btn {
            background: rgba(255, 215, 0, 0.9);
            color: #bc002d;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            transition: all 0.3s;
        }

        .music-btn:hover {
            transform: scale(1.1);
            background: rgba(255, 215, 0, 1);
        }

        /* Responsive */
        @media (max-width: 1400px) {
            .cards-container {
                grid-template-columns: repeat(7, 1fr);
                grid-template-rows: repeat(8, 1fr);
                gap: 10px;
            }
            
            .money-amount {
                font-size: 1.4rem;
            }
            
            .tree-container {
                height: 110%;
                transform: scale(1.1);
            }
            
            .tree-svg {
                width: 110%;
                height: 110%;
            }
        }

        @media (max-width: 1024px) {
            .main-content {
                flex-direction: column;
                height: auto;
                gap: 40px;
            }
            
            .cards-container {
                grid-template-columns: repeat(9, 1fr);
                grid-template-rows: repeat(6, 1fr);
                height: 60vh;
            }
            
            .title h1 {
                font-size: 3rem;
            }
            
            .title p {
                font-size: 2rem;
            }
            
            .stats {
                gap: 30px;
            }
            
            .money-amount {
                font-size: 1.2rem;
                padding: 4px 6px;
            }
            
            .horse-icon {
                font-size: 1.6rem;
            }
            
            .card-text {
                font-size: 0.7rem;
            }
            
            .tree-container {
                height: 100%;
                transform: scale(1);
                margin-bottom: 0;
            }
            
            .tree-svg {
                width: 100%;
                height: 100%;
            }
            
            .tree-envelope {
                width: 50px;
                height: 70px;
                font-size: 1.5rem;
            }
        }

        @media (max-width: 768px) {
            .cards-container {
                grid-template-columns: repeat(6, 1fr);
                grid-template-rows: repeat(9, 1fr);
            }
            
            .title h1 {
                font-size: 2.5rem;
            }
            
            .title p {
                font-size: 1.8rem;
            }
            
            .stats {
                flex-direction: column;
                gap: 20px;
            }
            
            .money-amount {
                font-size: 1rem;
                padding: 3px 4px;
            }
            
            .horse-icon {
                font-size: 1.4rem;
            }
            
            .card-text {
                font-size: 0.6rem;
            }
            
            .tree-envelope {
                width: 40px;
                height: 60px;
                font-size: 1.2rem;
            }
        }
    </style>
</head>
<body>
    <!-- H√¨nh n·ªÅn T·∫øt -->
    <div class="tet-background"></div>
    
    <!-- Canvas ph√°o hoa n·ªÅn -->
    <canvas id="backgroundFireworks"></canvas>
    
    <!-- N√∫t ƒëi·ªÅu khi·ªÉn √¢m nh·∫°c -->
    <div class="music-control">
        <button id="musicToggle" class="music-btn">
            <i class="fas fa-volume-up"></i>
        </button>
    </div>
    
    <!-- Audio cho nh·∫°c T·∫øt -->
    <audio id="tetMusic" loop>
        <!-- THAY ƒê·ªîI D√íNG N√ÄY: Thay src="tet-music.mp3" b·∫±ng file nh·∫°c c·ªßa b·∫°n -->
        <source src="tet-music.mp3" type="audio/mpeg">
        <source src="https://assets.mixkit.co/music/preview/mixkit-happy-new-year-2019-479.mp3" type="audio/mpeg">
    </audio>
    
    <!-- Container ch√≠nh -->
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="title">
                <h1>üéâ CH√öC M·ª™NG NƒÇM M·ªöI 2026 üéâ</h1>
                <p>An Khang - Th·ªãnh V∆∞·ª£ng</p>
            </div>
        </div>
        
        <!-- N·ªôi dung ch√≠nh -->
        <div class="main-content">
            <!-- C·ªôt b√™n tr√°i - C√¢y ƒë√†o -->
            <div class="left-column">
                <div class="tree-container">
                    <div class="tree" id="peachTree">
                        <!-- C√¢y ƒë√†o SVG s·∫Ω ƒë∆∞·ª£c ch√®n b·∫±ng JavaScript -->
                    </div>
                </div>
            </div>
            
            <!-- C·ªôt gi·ªØa - 54 th·∫ª b√†i -->
            <div class="center-column">
                <div class="cards-container" id="cardsContainer">
                    <!-- 54 th·∫ª b√†i s·∫Ω ƒë∆∞·ª£c t·∫°o b·∫±ng JavaScript -->
                </div>
            </div>
            
            <!-- C·ªôt b√™n ph·∫£i - C√¢y mai -->
            <div class="right-column">
                <div class="tree-container">
                    <div class="tree" id="apricotTree">
                        <!-- C√¢y mai SVG s·∫Ω ƒë∆∞·ª£c ch√®n b·∫±ng JavaScript -->
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Th√¥ng tin -->
        <div class="info">
            <div class="stats">
                <div class="stat-item">
                    <i class="fas fa-horse-head"></i> 
                    <span>L√¨ x√¨ ƒë√£ m·ªü: <span id="openedCount">0</span>/54</span>
                </div>
                <div class="stat-item">
                    <i class="fas fa-money-bill-wave"></i> 
                    <span>T·ªïng ti·ªÅn: <span id="totalMoney">0</span> VND</span>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        // L·ªõp ch√≠nh ƒëi·ªÅu khi·ªÉn ·ª©ng d·ª•ng
        class Tet2026App {
            constructor() {
                this.cards = [];
                this.totalMoney = 0;
                this.openedCount = 0;
                this.cardValues = this.generateCardValues(); // 54 th·∫ª
                this.cardIcons = ['üêé', 'üèá', 'üé†', 'ü¶Ñ'];
                this.isAnimating = false;
                this.fallingItemsCount = 0;
                this.fireworks = [];
                
                // DOM Elements
                this.cardsContainer = document.getElementById('cardsContainer');
                this.openedCountDisplay = document.getElementById('openedCount');
                this.totalMoneyDisplay = document.getElementById('totalMoney');
                this.musicToggle = document.getElementById('musicToggle');
                this.tetMusic = document.getElementById('tetMusic');
                this.peachTree = document.getElementById('peachTree');
                this.apricotTree = document.getElementById('apricotTree');
                this.canvas = document.getElementById('backgroundFireworks');
                this.ctx = this.canvas.getContext('2d');
                
                // Kh·ªüi t·∫°o
                this.init();
            }
            
            // T·∫°o gi√° tr·ªã cho 54 th·∫ª b√†i
            generateCardValues() {
                const values = [];
                
                // 1 x 100k
                values.push(100000);
                
                // 5 x 50k
                for (let i = 0; i < 5; i++) values.push(50000);
                
                // 20 x 20k
                for (let i = 0; i < 20; i++) values.push(20000);
                
                // 23 x 10k (20 + 3 th√™m)
                for (let i = 0; i < 23; i++) values.push(10000);
                
                // 5 x 5k
                for (let i = 0; i < 5; i++) values.push(5000);
                
                // X√°o tr·ªôn c√°c gi√° tr·ªã
                return this.shuffleArray(values);
            }
            
            // H√†m x√°o tr·ªôn m·∫£ng
            shuffleArray(array) {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
                return array;
            }
            
            init() {
                // Thi·∫øt l·∫≠p k√≠ch th∆∞·ªõc canvas
                this.resizeCanvas();
                window.addEventListener('resize', () => this.resizeCanvas());
                
                this.createCards();
                this.createTreeSVGs();
                this.startFallingItems();
                this.startBackgroundFireworks();
                this.setupMusic();
                
                // B·∫Øt ƒë·∫ßu v√≤ng l·∫∑p animation
                this.animate();
            }
            
            resizeCanvas() {
                this.canvas.width = window.innerWidth;
                this.canvas.height = window.innerHeight;
            }
            
            // T·∫°o 54 th·∫ª b√†i - S·ªë ti·ªÅn v·ª´a v·ªõi bao l√¨ x√¨
            createCards() {
                this.cardsContainer.innerHTML = '';
                
                for (let i = 0; i < 54; i++) {
                    const card = document.createElement('div');
                    card.className = 'card';
                    card.dataset.index = i;
                    card.dataset.value = this.cardValues[i];
                    
                    const randomIcon = this.cardIcons[Math.floor(Math.random() * this.cardIcons.length)];
                    
                    // T·∫°o s·ªë ti·ªÅn hi·ªÉn th·ªã g·ªçn g√†ng
                    const moneyText = this.formatMoney(this.cardValues[i]);
                    
                    card.innerHTML = `
                        <div class="card-inner">
                            <div class="card-front">
                                <div class="horse-icon">${randomIcon}</div>
                                <div class="card-text">T·∫æT 2026</div>
                            </div>
                            <div class="card-back">
                                <div class="money-amount">${moneyText}</div>
                            </div>
                        </div>
                    `;
                    
                    // S·ª± ki·ªán click
                    card.addEventListener('click', () => {
                        if (!card.classList.contains('flipped') && !this.isAnimating) {
                            this.flipCard(card, i);
                        }
                    });
                    
                    this.cardsContainer.appendChild(card);
                    this.cards.push(card);
                }
            }
            
            // L·∫≠t th·∫ª b√†i
            flipCard(card, index) {
                this.isAnimating = true;
                
                // L·∫≠t th·∫ª
                card.classList.add('flipped');
                
                // C·∫≠p nh·∫≠t th√¥ng tin
                const value = parseInt(card.dataset.value);
                setTimeout(() => {
                    this.totalMoney += value;
                    this.openedCount++;
                    
                    this.totalMoneyDisplay.textContent = this.formatMoneySimple(this.totalMoney);
                    this.openedCountDisplay.textContent = this.openedCount;
                    
                    // Ph√°o hoa
                    this.createFirework(
                        Math.random() * this.canvas.width,
                        Math.random() * this.canvas.height / 2
                    );
                    
                    // Th√™m v·∫≠t ph·∫©m r∆°i
                    this.createFallingItemFromTree();
                    
                    // Ki·ªÉm tra k·∫øt th√∫c
                    if (this.openedCount >= 54) {
                        setTimeout(() => this.showFinalCelebration(), 1500);
                    }
                    
                    this.isAnimating = false;
                }, 800);
            }
            
            // T·∫°o c√¢y ƒë√†o v√† mai b·∫±ng SVG - ƒê√É S·ª¨A: K√≠ch th∆∞·ªõc l·ªõn h∆°n
            createTreeSVGs() {
                // T·∫°o c√¢y ƒë√†o v·ªõi k√≠ch th∆∞·ªõc l·ªõn h∆°n
                this.createPeachTree();
                
                // T·∫°o c√¢y mai v·ªõi k√≠ch th∆∞·ªõc l·ªõn h∆°n
                this.createApricotTree();
                
                // Th√™m l√¨ x√¨ treo tr√™n c√¢y
                this.createTreeEnvelopes();
            }
            
            // T·∫°o c√¢y ƒë√†o SVG ƒë·∫πp v·ªõi k√≠ch th∆∞·ªõc l·ªõn h∆°n
            createPeachTree() {
                const svgNS = "http://www.w3.org/2000/svg";
                const svg = document.createElementNS(svgNS, "svg");
                svg.setAttribute("width", "100%");
                svg.setAttribute("height", "100%");
                svg.setAttribute("viewBox", "0 0 500 700"); // TƒÉng viewBox l√™n
                svg.classList.add("tree-svg");
                
                // Th√¢n c√¢y ch√≠nh - D√†y h∆°n
                const trunk = document.createElementNS(svgNS, "path");
                trunk.setAttribute("d", "M250,650 C250,580 220,500 250,450 C280,400 220,350 250,300 C280,250 220,150 250,100");
                trunk.setAttribute("fill", "#8B4513");
                trunk.setAttribute("stroke", "#654321");
                trunk.setAttribute("stroke-width", "4");
                svg.appendChild(trunk);
                
                // C√†nh l·ªõn b√™n tr√°i - D√†y h∆°n
                const leftBranch1 = document.createElementNS(svgNS, "path");
                leftBranch1.setAttribute("d", "M250,450 Q180,400 140,350");
                leftBranch1.setAttribute("fill", "none");
                leftBranch1.setAttribute("stroke", "#8B4513");
                leftBranch1.setAttribute("stroke-width", "20");
                leftBranch1.setAttribute("stroke-linecap", "round");
                svg.appendChild(leftBranch1);
                
                const leftBranch2 = document.createElementNS(svgNS, "path");
                leftBranch2.setAttribute("d", "M250,350 Q200,300 170,250");
                leftBranch2.setAttribute("fill", "none");
                leftBranch2.setAttribute("stroke", "#8B4513");
                leftBranch2.setAttribute("stroke-width", "15");
                leftBranch2.setAttribute("stroke-linecap", "round");
                svg.appendChild(leftBranch2);
                
                // C√†nh l·ªõn b√™n ph·∫£i - D√†y h∆°n
                const rightBranch1 = document.createElementNS(svgNS, "path");
                rightBranch1.setAttribute("d", "M250,450 Q320,400 360,350");
                rightBranch1.setAttribute("fill", "none");
                rightBranch1.setAttribute("stroke", "#8B4513");
                rightBranch1.setAttribute("stroke-width", "20");
                rightBranch1.setAttribute("stroke-linecap", "round");
                svg.appendChild(rightBranch1);
                
                const rightBranch2 = document.createElementNS(svgNS, "path");
                rightBranch2.setAttribute("d", "M250,350 Q300,300 330,250");
                rightBranch2.setAttribute("fill", "none");
                rightBranch2.setAttribute("stroke", "#8B4513");
                rightBranch2.setAttribute("stroke-width", "15");
                rightBranch2.setAttribute("stroke-linecap", "round");
                svg.appendChild(rightBranch2);
                
                // Th√™m nhi·ªÅu c√†nh nh·ªè h∆°n
                const smallBranches = [
                    {d: "M250,550 Q200,500 180,450", width: 12},
                    {d: "M250,550 Q300,500 320,450", width: 12},
                    {d: "M250,250 Q180,200 160,150", width: 10},
                    {d: "M250,250 Q320,200 340,150", width: 10}
                ];
                
                smallBranches.forEach(branch => {
                    const path = document.createElementNS(svgNS, "path");
                    path.setAttribute("d", branch.d);
                    path.setAttribute("fill", "none");
                    path.setAttribute("stroke", "#8B4513");
                    path.setAttribute("stroke-width", branch.width);
                    path.setAttribute("stroke-linecap", "round");
                    svg.appendChild(path);
                });
                
                // T·∫°o nhi·ªÅu hoa ƒë√†o h∆°n (m√†u h·ªìng)
                const peachBlossomColors = ['#FFB6C1', '#FF69B4', '#FF1493', '#DB7093'];
                for (let i = 0; i < 60; i++) {
                    const x = 100 + Math.random() * 300;
                    const y = 150 + Math.random() * 400;
                    
                    const blossomGroup = document.createElementNS(svgNS, "g");
                    blossomGroup.setAttribute("transform", `translate(${x}, ${y})`);
                    
                    // C√°nh hoa (5 c√°nh)
                    for (let j = 0; j < 5; j++) {
                        const angle = (j * 72) * Math.PI / 180;
                        const petal = document.createElementNS(svgNS, "ellipse");
                        petal.setAttribute("rx", "8");
                        petal.setAttribute("ry", "12");
                        petal.setAttribute("transform", `rotate(${j * 72})`);
                        petal.setAttribute("fill", peachBlossomColors[Math.floor(Math.random() * peachBlossomColors.length)]);
                        petal.setAttribute("opacity", "0.9");
                        blossomGroup.appendChild(petal);
                    }
                    
                    // Nh·ª•y hoa
                    const center = document.createElementNS(svgNS, "circle");
                    center.setAttribute("r", "5");
                    center.setAttribute("fill", "#FFD700");
                    blossomGroup.appendChild(center);
                    
                    svg.appendChild(blossomGroup);
                }
                
                // Th√™m nhi·ªÅu l√° c√¢y ƒë√†o h∆°n
                for (let i = 0; i < 40; i++) {
                    const x = 100 + Math.random() * 300;
                    const y = 200 + Math.random() * 400;
                    const size = 10 + Math.random() * 12;
                    
                    const leaf = document.createElementNS(svgNS, "ellipse");
                    leaf.setAttribute("cx", x);
                    leaf.setAttribute("cy", y);
                    leaf.setAttribute("rx", size);
                    leaf.setAttribute("ry", size/2);
                    leaf.setAttribute("fill", "#32CD32");
                    leaf.setAttribute("opacity", "0.8");
                    leaf.setAttribute("transform", `rotate(${Math.random() * 360}, ${x}, ${y})`);
                    svg.appendChild(leaf);
                }
                
                this.peachTree.innerHTML = '';
                this.peachTree.appendChild(svg);
            }
            
            // T·∫°o c√¢y mai SVG ƒë·∫πp v·ªõi k√≠ch th∆∞·ªõc l·ªõn h∆°n
            createApricotTree() {
                const svgNS = "http://www.w3.org/2000/svg";
                const svg = document.createElementNS(svgNS, "svg");
                svg.setAttribute("width", "100%");
                svg.setAttribute("height", "100%");
                svg.setAttribute("viewBox", "0 0 500 700"); // TƒÉng viewBox l√™n
                svg.classList.add("tree-svg");
                svg.style.animationDelay = "1s";
                
                // Th√¢n c√¢y ch√≠nh (m√†u n√¢u ƒë·∫≠m h∆°n) - D√†y h∆°n
                const trunk = document.createElementNS(svgNS, "path");
                trunk.setAttribute("d", "M250,650 C250,580 280,500 250,450 C220,400 280,350 250,300 C220,250 280,150 250,100");
                trunk.setAttribute("fill", "#654321");
                trunk.setAttribute("stroke", "#4B3621");
                trunk.setAttribute("stroke-width", "4");
                svg.appendChild(trunk);
                
                // C√†nh mai (cong h∆°n, d√†y h∆°n)
                const branches = [
                    {d: "M250,500 Q160,450 120,380", width: 18},
                    {d: "M250,500 Q340,450 380,380", width: 18},
                    {d: "M250,400 Q180,350 150,280", width: 15},
                    {d: "M250,400 Q320,350 350,280", width: 15},
                    {d: "M250,300 Q200,250 180,200", width: 12},
                    {d: "M250,300 Q300,250 320,200", width: 12},
                    {d: "M250,200 Q220,150 210,120", width: 10},
                    {d: "M250,200 Q280,150 290,120", width: 10}
                ];
                
                branches.forEach(branch => {
                    const path = document.createElementNS(svgNS, "path");
                    path.setAttribute("d", branch.d);
                    path.setAttribute("fill", "none");
                    path.setAttribute("stroke", "#654321");
                    path.setAttribute("stroke-width", branch.width);
                    path.setAttribute("stroke-linecap", "round");
                    svg.appendChild(path);
                });
                
                // Hoa mai (m√†u v√†ng) - Nhi·ªÅu h∆°n
                const apricotBlossomColors = ['#FFD700', '#FFA500', '#FF8C00', '#FF6347'];
                for (let i = 0; i < 70; i++) {
                    const x = 100 + Math.random() * 300;
                    const y = 150 + Math.random() * 400;
                    
                    const blossomGroup = document.createElementNS(svgNS, "g");
                    blossomGroup.setAttribute("transform", `translate(${x}, ${y})`);
                    
                    // Hoa mai th∆∞·ªùng c√≥ 5 c√°nh nh·ªè
                    for (let j = 0; j < 5; j++) {
                        const angle = (j * 72) * Math.PI / 180;
                        const petal = document.createElementNS(svgNS, "ellipse");
                        petal.setAttribute("rx", "6");
                        petal.setAttribute("ry", "10");
                        petal.setAttribute("transform", `rotate(${j * 72})`);
                        petal.setAttribute("fill", apricotBlossomColors[Math.floor(Math.random() * apricotBlossomColors.length)]);
                        petal.setAttribute("opacity", "0.9");
                        blossomGroup.appendChild(petal);
                    }
                    
                    // Nh·ª•y hoa m√†u ƒë·ªè
                    const center = document.createElementNS(svgNS, "circle");
                    center.setAttribute("r", "4");
                    center.setAttribute("fill", "#FF0000");
                    blossomGroup.appendChild(center);
                    
                    svg.appendChild(blossomGroup);
                }
                
                // N·ª• hoa mai (h√¨nh tr√≤n nh·ªè) - Nhi·ªÅu h∆°n
                for (let i = 0; i < 30; i++) {
                    const x = 100 + Math.random() * 300;
                    const y = 200 + Math.random() * 400;
                    
                    const bud = document.createElementNS(svgNS, "circle");
                    bud.setAttribute("cx", x);
                    bud.setAttribute("cy", y);
                    bud.setAttribute("r", "4");
                    bud.setAttribute("fill", "#FF4500");
                    bud.setAttribute("opacity", "0.8");
                    svg.appendChild(bud);
                }
                
                this.apricotTree.innerHTML = '';
                this.apricotTree.appendChild(svg);
            }
            
            // T·∫°o l√¨ x√¨ treo tr√™n c√¢y
            createTreeEnvelopes() {
                const texts = ['PH√öC', 'L·ªòC', 'TH·ªå'];
                
                // L√¨ x√¨ tr√™n c√¢y ƒë√†o - Nhi·ªÅu h∆°n
                for (let i = 0; i < 8; i++) {
                    const envelope = document.createElement('div');
                    envelope.className = 'tree-envelope';
                    envelope.textContent = texts[Math.floor(Math.random() * texts.length)];
                    
                    // ƒê·∫∑t v·ªã tr√≠ ng·∫´u nhi√™n tr√™n c√¢y
                    envelope.style.left = `${15 + Math.random() * 70}%`;
                    envelope.style.top = `${20 + Math.random() * 60}%`;
                    envelope.style.animationDelay = `${Math.random() * 4}s`;
                    
                    this.peachTree.appendChild(envelope);
                }
                
                // L√¨ x√¨ tr√™n c√¢y mai - Nhi·ªÅu h∆°n
                for (let i = 0; i < 8; i++) {
                    const envelope = document.createElement('div');
                    envelope.className = 'tree-envelope';
                    envelope.textContent = texts[Math.floor(Math.random() * texts.length)];
                    
                    // ƒê·∫∑t v·ªã tr√≠ ng·∫´u nhi√™n tr√™n c√¢y
                    envelope.style.left = `${15 + Math.random() * 70}%`;
                    envelope.style.top = `${20 + Math.random() * 60}%`;
                    envelope.style.animationDelay = `${Math.random() * 4}s`;
                    
                    this.apricotTree.appendChild(envelope);
                }
            }
            
            // V·∫≠t ph·∫©m r∆°i d√†y ƒë·∫∑c t·ª´ c√¢y
            startFallingItems() {
                // T·∫°o nhi·ªÅu v·∫≠t ph·∫©m r∆°i li√™n t·ª•c
                setInterval(() => {
                    // T·ª´ c√¢y ƒë√†o
                    this.createFallingItem(this.peachTree, ['üßß', 'ü™ô', 'üí∞', 'üéÅ']);
                    
                    // T·ª´ c√¢y mai
                    this.createFallingItem(this.apricotTree, ['‚ú®', '‚≠ê', 'üåü', 'üí´']);
                }, 200);
            }
            
            // T·∫°o v·∫≠t ph·∫©m r∆°i t·ª´ c√¢y khi l·∫≠t th·∫ª
            createFallingItemFromTree() {
                const items = ['üßß', 'ü™ô', 'üí∞', 'üéÅ', '‚ú®', '‚≠ê', 'üåü', 'üí´'];
                
                // T·∫°o nhi·ªÅu v·∫≠t ph·∫©m c√πng l√∫c
                for (let i = 0; i < 5; i++) {
                    setTimeout(() => {
                        // Ng·∫´u nhi√™n t·ª´ c√¢y ƒë√†o ho·∫∑c mai
                        const tree = Math.random() > 0.5 ? this.peachTree : this.apricotTree;
                        this.createFallingItem(tree, items);
                    }, i * 100);
                }
            }
            
            createFallingItem(treeElement, items) {
                const item = document.createElement('div');
                item.className = 'falling-item';
                item.textContent = items[Math.floor(Math.random() * items.length)];
                
                // ƒê·∫∑t v·ªã tr√≠ ng·∫´u nhi√™n tr√™n c√¢y
                const rect = treeElement.getBoundingClientRect();
                const left = rect.left + Math.random() * rect.width;
                
                item.style.left = `${left}px`;
                item.style.top = `${rect.top + 50}px`;
                item.style.fontSize = `${1.5 + Math.random() * 2}rem`;
                item.style.animationDuration = `${2 + Math.random() * 2}s`;
                
                document.body.appendChild(item);
                
                // X√≥a sau khi r∆°i xong
                setTimeout(() => {
                    if (item.parentNode) {
                        item.remove();
                    }
                }, 4000);
            }
            
            // H·ªÜ TH·ªêNG PH√ÅO HOA
            createFirework(x, y) {
                const colors = ['#ff0000', '#00ff00', '#ffff00', '#ff00ff', '#00ffff', '#ff9500'];
                const color = colors[Math.floor(Math.random() * colors.length)];
                
                this.fireworks.push({
                    x: x,
                    y: y,
                    particles: this.createParticles(x, y, color),
                    createdAt: Date.now(),
                    duration: 1800
                });
            }
            
            createParticles(x, y, color) {
                const particles = [];
                const count = 120;
                
                for (let i = 0; i < count; i++) {
                    particles.push({
                        x: x,
                        y: y,
                        vx: (Math.random() - 0.5) * 10,
                        vy: (Math.random() - 0.5) * 10,
                        radius: Math.random() * 3 + 1,
                        color: color,
                        life: 1.0,
                        decay: 0.008 + Math.random() * 0.01,
                        gravity: 0.06
                    });
                }
                
                return particles;
            }
            
            // V√≤ng l·∫∑p animation cho ph√°o hoa
            animate() {
                // X√≥a canvas v·ªõi hi·ªáu ·ª©ng fade nh·∫π
                this.ctx.fillStyle = 'rgba(139, 0, 0, 0.08)';
                this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);
                
                // C·∫≠p nh·∫≠t v√† v·∫Ω ph√°o hoa
                for (let i = this.fireworks.length - 1; i >= 0; i--) {
                    const firework = this.fireworks[i];
                    const age = Date.now() - firework.createdAt;
                    
                    if (age > firework.duration) {
                        this.fireworks.splice(i, 1);
                        continue;
                    }
                    
                    this.drawFirework(firework);
                }
                
                requestAnimationFrame(() => this.animate());
            }
            
            drawFirework(firework) {
                firework.particles.forEach(particle => {
                    // C·∫≠p nh·∫≠t v·ªã tr√≠
                    particle.x += particle.vx;
                    particle.y += particle.vy + particle.gravity;
                    particle.life -= particle.decay;
                    
                    if (particle.life > 0) {
                        // V·∫Ω particle ch√≠nh
                        this.ctx.beginPath();
                        this.ctx.arc(particle.x, particle.y, particle.radius, 0, Math.PI * 2);
                        this.ctx.fillStyle = `rgba(${this.hexToRgb(particle.color)}, ${particle.life})`;
                        this.ctx.fill();
                        
                        // Hi·ªáu ·ª©ng s√°ng xung quanh
                        const gradient = this.ctx.createRadialGradient(
                            particle.x, particle.y, 0,
                            particle.x, particle.y, particle.radius * 3
                        );
                        gradient.addColorStop(0, `rgba(${this.hexToRgb(particle.color)}, ${particle.life * 0.4})`);
                        gradient.addColorStop(1, 'transparent');
                        
                        this.ctx.beginPath();
                        this.ctx.arc(particle.x, particle.y, particle.radius * 3, 0, Math.PI * 2);
                        this.ctx.fillStyle = gradient;
                        this.ctx.fill();
                    }
                });
            }
            
            // Ph√°o hoa n·ªÅn li√™n t·ª•c
            startBackgroundFireworks() {
                setInterval(() => {
                    if (Math.random() > 0.4) {
                        this.createFirework(
                            Math.random() * this.canvas.width,
                            Math.random() * this.canvas.height
                        );
                    }
                }, 800);
            }
            
            // C√†i ƒë·∫∑t nh·∫°c T·∫øt
            setupMusic() {
                // T·ª± ƒë·ªông th·ª≠ ph√°t nh·∫°c
                const playMusic = () => {
                    this.tetMusic.volume = 0.6;
                    this.tetMusic.play().catch(e => {
                        console.log("ƒêang ch·ªù t∆∞∆°ng t√°c ƒë·ªÉ ph√°t nh·∫°c...");
                    });
                };
                
                // Th·ª≠ ph√°t ngay
                playMusic();
                
                // Ph√°t khi c√≥ t∆∞∆°ng t√°c ƒë·∫ßu ti√™n
                document.addEventListener('click', () => {
                    playMusic();
                }, { once: true });
                
                // N√∫t ƒëi·ªÅu khi·ªÉn √¢m nh·∫°c
                this.musicToggle.addEventListener('click', () => {
                    if (this.tetMusic.paused) {
                        this.tetMusic.play();
                        this.musicToggle.innerHTML = '<i class="fas fa-volume-up"></i>';
                    } else {
                        this.tetMusic.pause();
                        this.musicToggle.innerHTML = '<i class="fas fa-volume-mute"></i>';
                    }
                });
            }
            
            // Hi·ªÉn th·ªã m√†n h√¨nh k·∫øt th√∫c
            showFinalCelebration() {
                // Ph√°o hoa r·ª±c r·ª°
                for (let i = 0; i < 40; i++) {
                    setTimeout(() => {
                        this.createFirework(
                            Math.random() * this.canvas.width,
                            Math.random() * this.canvas.height
                        );
                    }, i * 80);
                }
                
                // Hi·ªÉn th·ªã th√¥ng b√°o
                setTimeout(() => {
                    alert(`üéä CH√öC M·ª™NG NƒÇM M·ªöI 2026 üéä\n\nT·ªïng s·ªë ti·ªÅn l√¨ x√¨: ${this.formatMoneySimple(this.totalMoney)} VND\n\nCh√∫c b·∫°n m·ªôt nƒÉm m·ªõi An Khang Th·ªãnh V∆∞·ª£ng, V·∫°n S·ª± Nh∆∞ √ù!`);
                }, 3000);
            }
            
            // Chuy·ªÉn hex sang rgb
            hexToRgb(hex) {
                const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
                return result ? 
                    `${parseInt(result[1], 16)}, ${parseInt(result[2], 16)}, ${parseInt(result[3], 16)}` : 
                    '255, 255, 255';
            }
            
            // ƒê·ªãnh d·∫°ng ti·ªÅn HI·ªÇN TH·ªä TR√äN TH·∫∫ - K√çCH TH∆Ø·ªöC V·ª™A PH·∫¢I
            formatMoney(amount) {
                // Chuy·ªÉn s·ªë ti·ªÅn th√†nh chu·ªói v·ªõi d·∫•u ch·∫•m ph√¢n c√°ch h√†ng ngh√¨n
                return amount.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
            }
            
            // ƒê·ªãnh d·∫°ng ti·ªÅn ƒë∆°n gi·∫£n cho t·ªïng ti·ªÅn
            formatMoneySimple(amount) {
                return amount.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
            }
        }
        
        // Kh·ªüi ch·∫°y ·ª©ng d·ª•ng
        document.addEventListener('DOMContentLoaded', () => {
            const app = new Tet2026App();
            window.tetApp = app;
        });
    </script>
</body>
</html>
